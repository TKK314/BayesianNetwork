<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 連続型データ事例：ガウシアン・ベイジアンネットワーク | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="3 連続型データ事例：ガウシアン・ベイジアンネットワーク | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 連続型データ事例：ガウシアン・ベイジアンネットワーク | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="離散型データ事例.html"/>
<link rel="next" href="混合事例条件付きガウシアンベイジアンネットワーク.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 本サイトについて</a></li>
<li class="chapter" data-level="2" data-path="離散型データ事例.html"><a href="離散型データ事例.html"><i class="fa fa-check"></i><b>2</b> 離散型データ事例</a>
<ul>
<li class="chapter" data-level="2.1" data-path="離散型データ事例.html"><a href="離散型データ事例.html#事例紹介交通手段に関する調査"><i class="fa fa-check"></i><b>2.1</b> 事例紹介：交通手段に関する調査</a></li>
<li class="chapter" data-level="2.2" data-path="離散型データ事例.html"><a href="離散型データ事例.html#グラフィカル表現"><i class="fa fa-check"></i><b>2.2</b> グラフィカル表現</a></li>
<li class="chapter" data-level="2.3" data-path="離散型データ事例.html"><a href="離散型データ事例.html#確率的表現"><i class="fa fa-check"></i><b>2.3</b> 確率的表現</a></li>
<li class="chapter" data-level="2.4" data-path="離散型データ事例.html"><a href="離散型データ事例.html#パラメータの推定条件付き確率表"><i class="fa fa-check"></i><b>2.4</b> パラメータの推定：条件付き確率表</a></li>
<li class="chapter" data-level="2.5" data-path="離散型データ事例.html"><a href="離散型データ事例.html#dag構造の学習検定とスコア"><i class="fa fa-check"></i><b>2.5</b> DAG構造の学習：検定とスコア</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="離散型データ事例.html"><a href="離散型データ事例.html#条件付き独立性検定"><i class="fa fa-check"></i><b>2.5.1</b> 条件付き独立性検定</a></li>
<li class="chapter" data-level="2.5.2" data-path="離散型データ事例.html"><a href="離散型データ事例.html#ネットワークスコア"><i class="fa fa-check"></i><b>2.5.2</b> ネットワークスコア</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="離散型データ事例.html"><a href="離散型データ事例.html#離散型データでベイジアンネットワークを使ってみよう"><i class="fa fa-check"></i><b>2.6</b> 離散型データでベイジアンネットワークを使ってみよう</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="離散型データ事例.html"><a href="離散型データ事例.html#dag構造を使って"><i class="fa fa-check"></i><b>2.6.1</b> DAG構造を使って</a></li>
<li class="chapter" data-level="2.6.2" data-path="離散型データ事例.html"><a href="離散型データ事例.html#条件付き確率表を使って"><i class="fa fa-check"></i><b>2.6.2</b> 条件付き確率表を使って</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="離散型データ事例.html"><a href="離散型データ事例.html#ベイジアンネットワークの図示"><i class="fa fa-check"></i><b>2.7</b> ベイジアンネットワークの図示</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="離散型データ事例.html"><a href="離散型データ事例.html#条件付き確率分布の図示"><i class="fa fa-check"></i><b>2.7.1</b> 条件付き確率分布の図示</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html"><i class="fa fa-check"></i><b>3</b> 連続型データ事例：ガウシアン・ベイジアンネットワーク</a>
<ul>
<li class="chapter" data-level="3.1" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#事例紹介"><i class="fa fa-check"></i><b>3.1</b> 事例紹介</a></li>
<li class="chapter" data-level="3.2" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#グラフィカル表現-1"><i class="fa fa-check"></i><b>3.2</b> グラフィカル表現</a></li>
<li class="chapter" data-level="3.3" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#確率的表現-1"><i class="fa fa-check"></i><b>3.3</b> 確率的表現</a></li>
<li class="chapter" data-level="3.4" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#パラメータの推定相関係数"><i class="fa fa-check"></i><b>3.4</b> パラメータの推定：相関係数</a></li>
<li class="chapter" data-level="3.5" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#dag構造の学習検定とスコア-1"><i class="fa fa-check"></i><b>3.5</b> DAG構造の学習：検定とスコア</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#条件付き独立性検定-1"><i class="fa fa-check"></i><b>3.5.1</b> 条件付き独立性検定</a></li>
<li class="chapter" data-level="3.5.2" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ネットワークスコア-1"><i class="fa fa-check"></i><b>3.5.2</b> ネットワークスコア</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ガウシアンベイジアンネットワークを使ってみよう"><i class="fa fa-check"></i><b>3.6</b> ガウシアン・ベイジアンネットワークを使ってみよう</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#厳密推論-1"><i class="fa fa-check"></i><b>3.6.1</b> 厳密推論</a></li>
<li class="chapter" data-level="3.6.2" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#近似推論-1"><i class="fa fa-check"></i><b>3.6.2</b> 近似推論</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ガウシアンベイジアンネットワークの図示"><i class="fa fa-check"></i><b>3.7</b> ガウシアン・ベイジアンネットワークの図示</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#dagの図示"><i class="fa fa-check"></i><b>3.7.1</b> DAGの図示</a></li>
<li class="chapter" data-level="3.7.2" data-path="連続型データ事例ガウシアンベイジアンネットワーク.html"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#条件付き確率分布の図示-1"><i class="fa fa-check"></i><b>3.7.2</b> 条件付き確率分布の図示</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html"><i class="fa fa-check"></i><b>4</b> 混合事例：条件付きガウシアン・ベイジアンネットワーク</a>
<ul>
<li class="chapter" data-level="4.1" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#事例紹介健康管理にかかるコスト"><i class="fa fa-check"></i><b>4.1</b> 事例紹介：健康管理にかかるコスト</a></li>
<li class="chapter" data-level="4.2" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#パラメータの推定混合回帰"><i class="fa fa-check"></i><b>4.2</b> パラメータの推定：混合回帰</a></li>
<li class="chapter" data-level="4.3" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#dag構造の学習検定とスコア-2"><i class="fa fa-check"></i><b>4.3</b> DAG構造の学習：検定とスコア</a></li>
<li class="chapter" data-level="4.4" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#条件付きガウシアンベイジアンネットワークを使ってみよう"><i class="fa fa-check"></i><b>4.4</b> 条件付きガウシアンベイジアンネットワークを使ってみよう</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#入院日数が少なくとも1日以上d1で少なくとも固定費が生じたi100場合を想定する"><i class="fa fa-check"></i><b>4.4.1</b> 入院日数が少なくとも1日以上(D&gt;=1)で、少なくとも固定費が生じた(I&gt;=100)場合を想定する</a></li>
<li class="chapter" data-level="4.4.2" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#入院日数dと既往歴cについて確認する"><i class="fa fa-check"></i><b>4.4.2</b> 入院日数(D)と既往歴(C)について確認する</a></li>
<li class="chapter" data-level="4.4.3" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#入院にかかる支出iと通院にかかる支出o医療費にかかる税金tに関してシミュレーションを実施"><i class="fa fa-check"></i><b>4.4.3</b> 入院にかかる支出(I)と通院にかかる支出(O)、医療費にかかる税金(T)に関して、シミュレーションを実施</a></li>
<li class="chapter" data-level="4.4.4" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#では現状の税金の額で将来健康管理システムを維持できるのか"><i class="fa fa-check"></i><b>4.4.4</b> では、現状の税金の額で将来健康管理システムを維持できるのか</a></li>
<li class="chapter" data-level="4.4.5" data-path="混合事例条件付きガウシアンベイジアンネットワーク.html"><a href="混合事例条件付きガウシアンベイジアンネットワーク.html#既往症の保有率が時間とともに変化するかもしれない仮説を検証"><i class="fa fa-check"></i><b>4.4.5</b> 既往症の保有率が時間とともに変化するかもしれない仮説を検証</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="連続型データ事例ガウシアンベイジアンネットワーク" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> 連続型データ事例：ガウシアン・ベイジアンネットワーク<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#連続型データ事例ガウシアンベイジアンネットワーク" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="事例紹介" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 事例紹介<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#事例紹介" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>いずれも連続型変数である</p>
<table>
<colgroup>
<col width="23%" />
<col width="18%" />
<col width="58%" />
</colgroup>
<thead>
<tr class="header">
<th>項目名</th>
<th>略語</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>遺伝的ポテンシャル</td>
<td>G</td>
<td></td>
</tr>
<tr class="even">
<td>環境的ポテンシャル</td>
<td>E</td>
<td></td>
</tr>
<tr class="odd">
<td>栄養器官</td>
<td>V</td>
<td>ある単一の植物に蓄えられる栄養に関する情報すべてを統合した変数</td>
</tr>
<tr class="even">
<td>種子の数</td>
<td>N</td>
<td>開花時期には判明する</td>
</tr>
<tr class="odd">
<td>種子の平均重量</td>
<td>W</td>
<td>植物の寿命の後期にならないとわからない</td>
</tr>
<tr class="even">
<td>作物の収穫量</td>
<td>C</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="グラフィカル表現-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> グラフィカル表現<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#グラフィカル表現-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb103-1" tabindex="-1"></a><span class="fu">library</span>(bnlearn)</span>
<span id="cb103-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb103-2" tabindex="-1"></a>dag.bnlearn <span class="ot">&lt;-</span> <span class="fu">model2network</span>(<span class="st">&quot;[G][E][V|G:E][N|V][W|V][C|N:W]&quot;</span>)</span>
<span id="cb103-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb103-3" tabindex="-1"></a>dag.bnlearn</span></code></pre></div>
<pre><code>## 
##   Random/Generated Bayesian network
## 
##   model:
##    [E][G][V|E:G][N|V][W|V][C|N:W] 
##   nodes:                                 6 
##   arcs:                                  6 
##     undirected arcs:                     0 
##     directed arcs:                       6 
##   average markov blanket size:           2.67 
##   average neighbourhood size:            2.00 
##   average branching factor:              1.00 
## 
##   generation algorithm:                  Empty</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb105-1" tabindex="-1"></a><span class="fu">graphviz.plot</span>(dag.bnlearn)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-1" tabindex="-1"></a><span class="co">#どの変数の組み合わせが周辺的に独立しているか確認する</span></span>
<span id="cb106-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-2" tabindex="-1"></a>crop.nodes <span class="ot">&lt;-</span> <span class="fu">nodes</span>(dag.bnlearn)</span>
<span id="cb106-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-3" tabindex="-1"></a><span class="cf">for</span>(n1 <span class="cf">in</span> crop.nodes){</span>
<span id="cb106-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-4" tabindex="-1"></a>  <span class="cf">for</span>(n2 <span class="cf">in</span> crop.nodes){</span>
<span id="cb106-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-5" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">dsep</span>(dag.bnlearn, n1, n2))</span>
<span id="cb106-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-6" tabindex="-1"></a>       <span class="fu">cat</span>(n1, <span class="st">&quot;and&quot;</span>, n2, <span class="st">&quot;are independent.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb106-7"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-7" tabindex="-1"></a>  }</span>
<span id="cb106-8"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb106-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## E and G are independent.
## G and E are independent.</code></pre>
<p>EとGのみが独立している、独立性は対称的だった</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-1" tabindex="-1"></a><span class="co">#変数をすべての組あわせで対にして、栄養器官(V)で条件づけられた場合にどのペアが条件付き独立となるか確認できる</span></span>
<span id="cb108-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-2" tabindex="-1"></a><span class="cf">for</span>(n1 <span class="cf">in</span> crop.nodes[crop.nodes <span class="sc">!=</span> <span class="st">&quot;V&quot;</span>]){</span>
<span id="cb108-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-3" tabindex="-1"></a>  <span class="cf">for</span>(n2 <span class="cf">in</span> crop.nodes[crop.nodes <span class="sc">!=</span> <span class="st">&quot;V&quot;</span>]){</span>
<span id="cb108-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-4" tabindex="-1"></a>   <span class="cf">if</span>(n1<span class="sc">&lt;</span>n2){</span>
<span id="cb108-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-5" tabindex="-1"></a>     <span class="cf">if</span>(<span class="fu">dsep</span>(dag.bnlearn, n1, n2, <span class="st">&quot;V&quot;</span>))</span>
<span id="cb108-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-6" tabindex="-1"></a>       <span class="fu">cat</span>(n1, <span class="st">&quot;and&quot;</span>, n2, <span class="st">&quot;are independent given V.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb108-7"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-7" tabindex="-1"></a>   } </span>
<span id="cb108-8"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-8" tabindex="-1"></a>  }</span>
<span id="cb108-9"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb108-9" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## C and E are independent given V.
## C and G are independent given V.
## E and N are independent given V.
## E and W are independent given V.
## G and N are independent given V.
## G and W are independent given V.
## N and W are independent given V.</code></pre>
<p>Vで条件づけられるとEとGは独立ではない</p>
</div>
<div id="確率的表現-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 確率的表現<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#確率的表現-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-1" tabindex="-1"></a><span class="co">#各パラメータの確率分布を定義する</span></span>
<span id="cb110-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-2" tabindex="-1"></a>E.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="dv">50</span>), <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb110-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-3" tabindex="-1"></a>G.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="dv">50</span>), <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb110-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-4" tabindex="-1"></a>V.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">10.35534</span>, <span class="at">E =</span> <span class="fl">0.70711</span>, <span class="at">G =</span> <span class="fl">0.5</span>), <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb110-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-5" tabindex="-1"></a>N.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="dv">45</span>, <span class="at">V =</span> <span class="fl">0.1</span>), <span class="at">sd =</span> <span class="fl">9.949874</span>)</span>
<span id="cb110-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-6" tabindex="-1"></a>W.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="dv">15</span>, <span class="at">V =</span> <span class="fl">0.7</span>), <span class="at">sd =</span> <span class="fl">7.141428</span>)</span>
<span id="cb110-7"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-7" tabindex="-1"></a>C.dist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">coef =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="at">N =</span> <span class="fl">0.3</span>, <span class="at">W =</span> <span class="fl">0.7</span>), <span class="at">sd =</span> <span class="fl">6.25</span>)</span>
<span id="cb110-8"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb110-8" tabindex="-1"></a>dist.list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">E =</span> E.dist, <span class="at">G =</span> G.dist, <span class="at">V =</span> V.dist, <span class="at">N =</span> N.dist, <span class="at">W =</span> W.dist, <span class="at">C =</span> C.dist)</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb111-1" tabindex="-1"></a>gbn.bnlearn <span class="ot">&lt;-</span> <span class="fu">custom.fit</span>(dag.bnlearn, <span class="at">dist =</span> dist.list)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb112-1" tabindex="-1"></a><span class="co">#局所分布のパラメータ</span></span>
<span id="cb112-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb112-2" tabindex="-1"></a>gbn.bnlearn<span class="sc">$</span>C</span></code></pre></div>
<pre><code>## 
##   Parameters of node C (Gaussian distribution)
## 
## Conditional density: C | N + W
## Coefficients:
## (Intercept)            N            W  
##         0.0          0.3          0.7  
## Standard deviation of the residuals: 6.25</code></pre>
<p>上記は線形ガウシアン・ベイジアンネットワークである</p>
<ul>
<li><p>すべてのノードは正規分布に基づく</p></li>
<li><p>親のノードをもたないノードは周辺分布により記述</p></li>
<li><p>各ノードの分散はそのノードに特有で親ノードに依存しない</p></li>
<li><p>各ノードの局所的分布は切片と親ノードを含んだ線形ガウシアンモデルとして表現</p></li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb114-1" tabindex="-1"></a><span class="co">#ガウシアン・ベイジアンネットワークに特化したRパッケージ</span></span>
<span id="cb114-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb114-2" tabindex="-1"></a><span class="fu">library</span>(rbmn)</span>
<span id="cb114-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb114-3" tabindex="-1"></a><span class="co">#bn.fitオブジェクトを変換する</span></span>
<span id="cb114-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb114-4" tabindex="-1"></a>gbn.rbmn <span class="ot">&lt;-</span> <span class="fu">bnfit2nbn</span>(gbn.bnlearn)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb115-1" tabindex="-1"></a><span class="co">#多変量正規分布のパラメータを得る</span></span>
<span id="cb115-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb115-2" tabindex="-1"></a>gema.rbmn <span class="ot">&lt;-</span> <span class="fu">nbn2gema</span>(gbn.rbmn)</span>
<span id="cb115-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb115-3" tabindex="-1"></a>mn.rbmn <span class="ot">&lt;-</span> <span class="fu">gema2mn</span>(gema.rbmn)</span>
<span id="cb115-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb115-4" tabindex="-1"></a><span class="fu">print8mn</span>(mn.rbmn)</span></code></pre></div>
<pre><code>##   mu s.d.   C.E  C.G   C.V   C.W   C.N   C.C
## E 50   10 1.000 0.00 0.707 0.495 0.071 0.368
## G 50   10 0.000 1.00 0.500 0.350 0.050 0.260
## V 50   10 0.707 0.50 1.000 0.700 0.100 0.520
## W 50   10 0.495 0.35 0.700 1.000 0.070 0.721
## N 50   10 0.071 0.05 0.100 0.070 1.000 0.349
## C 50   10 0.368 0.26 0.520 0.721 0.349 1.000</code></pre>
<p>1列目：周辺分布の期待値</p>
<p>2列目：周辺分布の標準偏差</p>
<p>3列目以降：相関行列</p>
</div>
<div id="パラメータの推定相関係数" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> パラメータの推定：相関係数<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#パラメータの推定相関係数" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>DAG構造は既知とする</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-1" tabindex="-1"></a><span class="co">#200の観測サンプルを生成して、cropdata200に格納する</span></span>
<span id="cb117-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb117-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-3" tabindex="-1"></a>cropdata200 <span class="ot">&lt;-</span> <span class="fu">rbn</span>(gbn.bnlearn, <span class="at">n =</span> <span class="dv">200</span>)</span>
<span id="cb117-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb117-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-5" tabindex="-1"></a>cropdata20k <span class="ot">&lt;-</span> <span class="fu">rbn</span>(gbn.bnlearn, <span class="at">n =</span> <span class="dv">20000</span>)</span>
<span id="cb117-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb117-6" tabindex="-1"></a><span class="fu">dim</span>(cropdata200)</span></code></pre></div>
<pre><code>## [1] 200   6</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb119-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(cropdata200), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##       C     E     G     N     V     W
## 1 48.83 51.48 42.64 54.10 42.96 41.96
## 2 48.85 73.43 40.97 60.07 65.29 48.96
## 3 67.01 71.10 52.52 51.64 63.22 62.03
## 4 37.83 49.33 56.15 49.01 47.75 38.77
## 5 55.30 49.27 63.55 54.62 60.57 56.66
## 6 56.12 48.72 66.02 43.95 55.54 52.39</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb121-1" tabindex="-1"></a><span class="co">#パラメータを推定する</span></span>
<span id="cb121-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb121-2" tabindex="-1"></a><span class="co">#変数が因子型でなければ自動的にガウシアン・ベイジアンネットワークと判断される</span></span>
<span id="cb121-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb121-3" tabindex="-1"></a>crop.fitted <span class="ot">&lt;-</span> <span class="fu">bn.fit</span>(dag.bnlearn, <span class="at">data =</span> cropdata200)</span>
<span id="cb121-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb121-4" tabindex="-1"></a>crop.fitted</span></code></pre></div>
<pre><code>## 
##   Bayesian network parameters
## 
##   Parameters of node C (Gaussian distribution)
## 
## Conditional density: C | N + W
## Coefficients:
## (Intercept)            N            W  
##   2.4026177    0.2734476    0.6858202  
## Standard deviation of the residuals: 6.31327 
## 
##   Parameters of node E (Gaussian distribution)
## 
## Conditional density: E
## Coefficients:
## (Intercept)  
##    50.80161  
## Standard deviation of the residuals: 10.7432 
## 
##   Parameters of node G (Gaussian distribution)
## 
## Conditional density: G
## Coefficients:
## (Intercept)  
##    50.14396  
## Standard deviation of the residuals: 9.798923 
## 
##   Parameters of node N (Gaussian distribution)
## 
## Conditional density: N | V
## Coefficients:
## (Intercept)            V  
## 51.81745022  -0.04461524  
## Standard deviation of the residuals: 9.531253 
## 
##   Parameters of node V (Gaussian distribution)
## 
## Conditional density: V | E + G
## Coefficients:
## (Intercept)            E            G  
## -10.4547647    0.7426946    0.4552872  
## Standard deviation of the residuals: 5.034309 
## 
##   Parameters of node W (Gaussian distribution)
## 
## Conditional density: W | V
## Coefficients:
## (Intercept)            V  
##  20.1555287    0.5899971  
## Standard deviation of the residuals: 6.792171</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb123-1" tabindex="-1"></a><span class="co">#特定のノードについて異なるパラメータ推定法を用いることもできる</span></span>
<span id="cb123-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb123-2" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="fu">lm</span>(C <span class="sc">~</span> N <span class="sc">+</span> W, <span class="at">data =</span> cropdata200)</span>
<span id="cb123-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb123-3" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C</span></code></pre></div>
<pre><code>## 
##   Parameters of node C (Gaussian distribution)
## 
## Conditional density: C | N + W
## Coefficients:
## (Intercept)            N            W  
##   2.4026177    0.2734476    0.6858202  
## Standard deviation of the residuals: 6.31327</code></pre>
<p>一般的な回帰モデルをもちいてパラメータ推定を行う</p>
<p>リッジ、ラッソ回帰などについては以下を参照</p>
<p><a href="https://aizine.ai/ridge-lasso-elasticnet/" class="uri">https://aizine.ai/ridge-lasso-elasticnet/</a></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb125-1" tabindex="-1"></a><span class="co">#収穫量Cについてリッジ回帰を当てはめてみる</span></span>
<span id="cb125-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb125-2" tabindex="-1"></a><span class="fu">library</span>(penalized)</span>
<span id="cb125-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb125-3" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="fu">penalized</span>(C <span class="sc">~</span> N <span class="sc">+</span> W, <span class="at">lambda1 =</span> <span class="dv">0</span>,</span>
<span id="cb125-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb125-4" tabindex="-1"></a>                           <span class="at">lambda2 =</span> <span class="fl">1.5</span>, <span class="at">data =</span> cropdata200)</span></code></pre></div>
<pre><code>## 12</code></pre>
<p>推定した値を真値（avg:50, sd:10)と比較する</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb127-1" tabindex="-1"></a>crop.fitted<span class="sc">$</span>E</span></code></pre></div>
<pre><code>## 
##   Parameters of node E (Gaussian distribution)
## 
## Conditional density: E
## Coefficients:
## (Intercept)  
##    50.80161  
## Standard deviation of the residuals: 10.7432</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb129-1" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C</span></code></pre></div>
<pre><code>## 
##   Parameters of node C (Gaussian distribution)
## 
## Conditional density: C | N + W
## Coefficients:
## (Intercept)            N            W  
##   2.4069159    0.2734233    0.6857580  
## Standard deviation of the residuals: 6.31327</code></pre>
<p>NやW、SDについては真値に近似しているが、切片が0とは遠いので以下で直接修正する</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb131-1" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="fu">lm</span>(C <span class="sc">~</span> N <span class="sc">+</span> W <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> cropdata200)</span>
<span id="cb131-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb131-2" tabindex="-1"></a>crop.fitted<span class="sc">$</span>C</span></code></pre></div>
<pre><code>## 
##   Parameters of node C (Gaussian distribution)
## 
## Conditional density: C | N + W
## Coefficients:
## (Intercept)            N            W  
##   0.0000000    0.2963220    0.7105197  
## Standard deviation of the residuals: 6.304969</code></pre>
</div>
<div id="dag構造の学習検定とスコア-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> DAG構造の学習：検定とスコア<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#dag構造の学習検定とスコア-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="条件付き独立性検定-1" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> 条件付き独立性検定<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#条件付き独立性検定-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb133-1" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">cor</span>(cropdata200[, <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;N&quot;</span>)])</span>
<span id="cb133-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb133-2" tabindex="-1"></a>cormat</span></code></pre></div>
<pre><code>##           C           W           N
## C 1.0000000  0.67479818  0.26480613
## W 0.6747982  1.00000000 -0.02597999
## N 0.2648061 -0.02597999  1.00000000</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-1" tabindex="-1"></a><span class="co">#cormat（相関行列）からinvcor(偏相関行列)を計算する</span></span>
<span id="cb135-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-2" tabindex="-1"></a><span class="co">#ほかのすべての変数で条件づけられた場合のXとYにおける偏相関という意味</span></span>
<span id="cb135-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-3" tabindex="-1"></a><span class="fu">library</span>(corpcor)</span>
<span id="cb135-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-4" tabindex="-1"></a>invcor <span class="ot">&lt;-</span> <span class="fu">cor2pcor</span>(cormat)</span>
<span id="cb135-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-5" tabindex="-1"></a><span class="fu">dimnames</span>(invcor) <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(cormat)</span>
<span id="cb135-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb135-6" tabindex="-1"></a>invcor</span></code></pre></div>
<pre><code>##           C          W          N
## C 1.0000000  0.7071522  0.3826989
## W 0.7071522  1.0000000 -0.2875974
## N 0.3826989 -0.2875974  1.0000000</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb137-1" tabindex="-1"></a><span class="co">#種子の数Nで条件づけられた場合に作物の収穫量Cと種子の平均重量Wは独立か、という仮説を検証できる</span></span>
<span id="cb137-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb137-2" tabindex="-1"></a><span class="fu">ci.test</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="at">test =</span> <span class="st">&quot;cor&quot;</span>, <span class="at">data =</span> cropdata200)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Correlation
## 
## data:  C ~ W | N
## cor = 0.70715, df = 197, p-value &lt; 2.2e-16
## alternative hypothesis: true value is not equal to 0</code></pre>
<p>有意な偏相関があったことから帰無仮説を棄却し、独立でないと言える</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb139-1" tabindex="-1"></a><span class="co">#200個のデータセットは大規模ではないので構造自体を学習させると以下のようになる</span></span>
<span id="cb139-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb139-2" tabindex="-1"></a>pdag1 <span class="ot">&lt;-</span> <span class="fu">iamb</span>(cropdata200, <span class="at">test =</span> <span class="st">&quot;cor&quot;</span>)</span>
<span id="cb139-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb139-3" tabindex="-1"></a><span class="fu">graphviz.plot</span>(pdag1)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb140-1" tabindex="-1"></a><span class="co">#20kのデータセットを用いると正しく予測できる</span></span>
<span id="cb140-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb140-2" tabindex="-1"></a>pdag2 <span class="ot">&lt;-</span> <span class="fu">iamb</span>(cropdata20k, <span class="at">test =</span> <span class="st">&quot;cor&quot;</span>)</span>
<span id="cb140-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb140-3" tabindex="-1"></a><span class="fu">graphviz.plot</span>(pdag2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb141-1" tabindex="-1"></a><span class="co">#一部アークの追加、削除ができる</span></span>
<span id="cb141-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb141-2" tabindex="-1"></a>wl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;V&quot;</span>, <span class="st">&quot;N&quot;</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb141-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb141-3" tabindex="-1"></a>pdag3 <span class="ot">&lt;-</span> <span class="fu">iamb</span>(cropdata200, <span class="at">test =</span> <span class="st">&quot;cor&quot;</span>, <span class="at">whitelist =</span> wl)</span>
<span id="cb141-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb141-4" tabindex="-1"></a><span class="fu">graphviz.plot</span>(pdag3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
<div id="ネットワークスコア-1" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> ネットワークスコア<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ネットワークスコア-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
BIC = \log\widehat{f}(E,G,V,N,W,C) - \frac{d}{2}\log n
\]</span></p>
<p>また事後確率のスコアとしてBGe(Bayesian Gaussian equivalent score)</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb142-1" tabindex="-1"></a><span class="fu">score</span>(dag.bnlearn, <span class="at">data =</span> cropdata20k, <span class="at">type =</span> <span class="st">&quot;bic-g&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -416421.2</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb144-1" tabindex="-1"></a><span class="fu">score</span>(dag.bnlearn, <span class="at">data =</span> cropdata20k, <span class="at">type =</span> <span class="st">&quot;bge&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -416494.5</code></pre>
</div>
</div>
<div id="ガウシアンベイジアンネットワークを使ってみよう" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> ガウシアン・ベイジアンネットワークを使ってみよう<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ガウシアンベイジアンネットワークを使ってみよう" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="厳密推論-1" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> 厳密推論<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#厳密推論-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb146-1" tabindex="-1"></a><span class="co">#まずどのようにBNが定義されているかを確認する</span></span>
<span id="cb146-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb146-2" tabindex="-1"></a><span class="fu">print8nbn</span>(gbn.rbmn)</span></code></pre></div>
<pre><code>## =====Nodes===[parents]   = Exp. (sd.dev)       
## -----------------------------------------------
## ---------E---[-]  = 50  (10)
## ---------G---[-]  = 50  (10)
## ---------V---[E,G]  = -10.355 + 0.707*E + 0.5*G  (5)
## ---------W---[V]  = 15 + 0.7*V  (7.141)
## ---------N---[V]  = 45 + 0.1*V  (9.95)
## ---------C---[N,W]  = 0.3*N + 0.7*W  (6.25)</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb148-1" tabindex="-1"></a><span class="fu">print8gema</span>(gema.rbmn)</span></code></pre></div>
<pre><code>##   mu     E1   E2  E3    E4    E5   E6
## E 50 10.000  0.0 0.0 0.000 0.000 0.00
## G 50  0.000 10.0 0.0 0.000 0.000 0.00
## V 50  7.071  5.0 5.0 0.000 0.000 0.00
## W 50  4.950  3.5 3.5 7.141 0.000 0.00
## N 50  0.707  0.5 0.5 0.000 9.950 0.00
## C 50  3.677  2.6 2.6 4.999 2.985 6.25</code></pre>
<p>別のノードの値を固定した場合の1つor複数のノードの条件付同時分布を算出可能</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb150-1" tabindex="-1"></a><span class="co">#Vを80に固定した場合のCの分布</span></span>
<span id="cb150-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb150-2" tabindex="-1"></a><span class="fu">print8mn</span>(<span class="fu">condi4joint</span>(mn.rbmn, <span class="at">par =</span> <span class="st">&quot;C&quot;</span>, <span class="at">pour =</span> <span class="st">&quot;V&quot;</span>, <span class="at">x2 =</span> <span class="dv">80</span>))</span></code></pre></div>
<pre><code>##     mu  s.d.
## C 65.6 8.542</code></pre>
</div>
<div id="近似推論-1" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> 近似推論<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#近似推論-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>シミュレーションを用いる</p>
<ul>
<li><p>直接的：rnb関数</p></li>
<li><p>制約的：cpquery/cpdist関数</p></li>
</ul>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb152-1" tabindex="-1"></a><span class="co">#(V,N)から観測値4つを生成する</span></span>
<span id="cb152-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb152-2" tabindex="-1"></a>nobs <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb152-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb152-3" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">rbn</span>(gbn.bnlearn, <span class="at">n =</span> nobs)</span>
<span id="cb152-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb152-4" tabindex="-1"></a>sim</span></code></pre></div>
<pre><code>##          C        E        G        N        V        W
## 1 65.41210 79.12004 67.14710 63.82861 79.28153 59.53187
## 2 46.01587 35.57628 59.05068 51.74454 37.51262 40.01539
## 3 63.36558 62.26097 48.24989 53.12280 57.59524 64.20510
## 4 40.36104 35.87449 59.02320 37.77818 50.75239 47.35855</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb154-1" tabindex="-1"></a><span class="co">#条件を付けて生成する</span></span>
<span id="cb154-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb154-2" tabindex="-1"></a><span class="co">#非常に良質な作物を生産するための種子の数や平均重量はどのようなものか</span></span>
<span id="cb154-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb154-3" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cpdist</span>(gbn.bnlearn, <span class="at">nodes =</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;W&quot;</span>), <span class="at">evidence =</span> (C <span class="sc">&gt;</span> <span class="dv">80</span>)))</span></code></pre></div>
<pre><code>##          C        N        W
## 1 82.73325 66.14010 73.51469
## 2 81.32917 66.46854 80.87893
## 3 83.71564 64.03459 75.02483
## 4 81.56583 55.56495 63.87066
## 5 81.67702 65.23859 65.27324
## 6 80.12171 59.03308 72.62500</code></pre>
<ul>
<li><p>“=”を使って単一値を条件づける場合はこのアプローチは不可能となる</p>
<ul>
<li>連続型分布において単一値はつねに確率がゼロであるから</li>
</ul></li>
<li><p>ただし以下のように尤度重み付け法を用いることで解決することができる</p></li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb156-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cpdist</span>(gbn.bnlearn, <span class="at">nodes =</span> <span class="fu">c</span>(<span class="st">&quot;V&quot;</span>,<span class="st">&quot;G&quot;</span>,<span class="st">&quot;E&quot;</span>),</span>
<span id="cb156-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb156-2" tabindex="-1"></a>            <span class="at">evidence =</span> <span class="fu">list</span>(<span class="at">G =</span> <span class="dv">10</span>, <span class="at">E =</span> <span class="dv">90</span>), <span class="at">method =</span> <span class="st">&quot;lw&quot;</span>), <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##          V  G  E
## 1 63.71504 10 90
## 2 62.78473 10 90
## 3 67.95987 10 90
## 4 53.36817 10 90
## 5 58.42986 10 90</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb158-1" tabindex="-1"></a><span class="co">#また特定のイベントに関する確率を算出できる</span></span>
<span id="cb158-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb158-2" tabindex="-1"></a><span class="fu">cpquery</span>(gbn.bnlearn, <span class="at">event =</span> (V <span class="sc">&gt;</span> <span class="dv">70</span>),</span>
<span id="cb158-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb158-3" tabindex="-1"></a>        <span class="at">evidence =</span> <span class="fu">list</span>(<span class="at">G =</span> <span class="dv">10</span>, <span class="at">E =</span> <span class="dv">90</span>), <span class="at">method =</span> <span class="st">&quot;lw&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.009666667</code></pre>
</div>
</div>
<div id="ガウシアンベイジアンネットワークの図示" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> ガウシアン・ベイジアンネットワークの図示<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#ガウシアンベイジアンネットワークの図示" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dagの図示" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> DAGの図示<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#dagの図示" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb160-1" tabindex="-1"></a><span class="co">#別の方法を用いて作図してみる</span></span>
<span id="cb160-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb160-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb160-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb160-3" tabindex="-1"></a><span class="fu">igraph.options</span>(<span class="at">print.full =</span> <span class="cn">TRUE</span>)</span>
<span id="cb160-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb160-4" tabindex="-1"></a>dag0.igraph <span class="ot">&lt;-</span> <span class="fu">graph.formula</span>(G<span class="sc">-+</span>V, E<span class="sc">-+</span>V, V<span class="sc">-+</span>N, V<span class="sc">-+</span>W, N<span class="sc">-+</span>C, W<span class="sc">-+</span>C)</span>
<span id="cb160-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb160-5" tabindex="-1"></a>dag0.igraph</span></code></pre></div>
<pre><code>## IGRAPH 5a01d1b DN-- 6 6 -- 
## + attr: name (v/c)
## + edges from 5a01d1b (vertex names):
## [1] G-&gt;V V-&gt;N V-&gt;W E-&gt;V N-&gt;C W-&gt;C</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb162-1" tabindex="-1"></a><span class="co">#bnから変換もできる</span></span>
<span id="cb162-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb162-2" tabindex="-1"></a>dag.igraph <span class="ot">&lt;-</span> <span class="fu">as.igraph</span>(dag.bnlearn)</span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb163-1" tabindex="-1"></a><span class="co">#ノードを表す</span></span>
<span id="cb163-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb163-2" tabindex="-1"></a><span class="fu">V</span>(dag.igraph)</span></code></pre></div>
<pre><code>## + 6/6 vertices, named, from 7471164:
## [1] C E G N V W</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb165-1" tabindex="-1"></a><span class="co">#エッジを表す</span></span>
<span id="cb165-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb165-2" tabindex="-1"></a><span class="fu">E</span>(dag.igraph)</span></code></pre></div>
<pre><code>## + 6/6 edges from 7471164 (vertex names):
## [1] G-&gt;V E-&gt;V V-&gt;N V-&gt;W N-&gt;C W-&gt;C</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="at">cex.main =</span> <span class="dv">2</span>)</span>
<span id="cb167-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-2" tabindex="-1"></a><span class="fu">plot</span>(dag.igraph, <span class="at">main =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">1: defaults&quot;</span>)</span>
<span id="cb167-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-3" tabindex="-1"></a>ly <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="dv">6</span>)</span>
<span id="cb167-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-4" tabindex="-1"></a><span class="fu">plot</span>(dag.igraph, <span class="at">layout =</span> ly, <span class="at">main =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">2: positioning&quot;</span>)</span>
<span id="cb167-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-5" tabindex="-1"></a>vcol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;darkgrey&quot;</span>, <span class="st">&quot;darkgrey&quot;</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb167-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-6" tabindex="-1"></a>lcol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;white&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb167-7"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb167-8"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-8" tabindex="-1"></a><span class="fu">plot</span>(dag.igraph, <span class="at">layout =</span> ly, <span class="at">frame =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">3: final&quot;</span>,</span>
<span id="cb167-9"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-9" tabindex="-1"></a>     <span class="at">vertex.color =</span> vcol, <span class="at">vertex.label.color =</span> lcol,</span>
<span id="cb167-10"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-10" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> <span class="dv">3</span>, <span class="at">vertex.size =</span> <span class="dv">50</span>,</span>
<span id="cb167-11"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb167-11" tabindex="-1"></a>     <span class="at">edge.arrow.size =</span> <span class="fl">0.8</span>, <span class="at">edge.color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
<div id="条件付き確率分布の図示-1" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> 条件付き確率分布の図示<a href="連続型データ事例ガウシアンベイジアンネットワーク.html#条件付き確率分布の図示-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ガウシアン・ベイジアンネットワークの局所的分布を図示するための関数はない</p>
<p>線形回帰モデルのための回帰診断図を利用することは可能</p>
<p>ただし、残差と当てはめ値がbn.fitオブジェクトに格納されている必要がある</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb168-1" tabindex="-1"></a>gbn.fit <span class="ot">&lt;-</span> <span class="fu">bn.fit</span>(dag.bnlearn, <span class="at">data =</span> cropdata20k)</span>
<span id="cb168-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb168-2" tabindex="-1"></a><span class="co">#残差に関するquantile-quantileプロット</span></span>
<span id="cb168-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb168-3" tabindex="-1"></a><span class="fu">bn.fit.qqplot</span>(gbn.fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb169-1" tabindex="-1"></a><span class="co">#理論上の正規密度分布と重ねた残差のヒストグラム</span></span>
<span id="cb169-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb169-2" tabindex="-1"></a><span class="fu">bn.fit.histogram</span>(gbn.fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb170-1" tabindex="-1"></a><span class="co">#当てはめ値に対する残差プロット</span></span>
<span id="cb170-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb170-2" tabindex="-1"></a><span class="fu">bn.fit.xyplot</span>(gbn.fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<!--#  結局これ見ても何を示しているのかよくわからない...-->
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb171-1" tabindex="-1"></a><span class="co">#一つのノードのみに着目した図もかける</span></span>
<span id="cb171-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb171-2" tabindex="-1"></a><span class="fu">bn.fit.qqplot</span>(gbn.fit<span class="sc">$</span>C)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>環境的ポテンシャルEと栄養期間Vの組み合わせに対してどのように収穫量Cが変化するのかについて興味があるとする（C|E,V)</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb172-1" tabindex="-1"></a>C.EV <span class="ot">&lt;-</span> <span class="fu">condi4joint</span>(mn.rbmn, <span class="at">par =</span> <span class="st">&quot;C&quot;</span>, <span class="at">pour =</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>, <span class="st">&quot;V&quot;</span>), <span class="at">x2 =</span> <span class="cn">NULL</span>)</span>
<span id="cb172-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb172-2" tabindex="-1"></a>C.EV<span class="sc">$</span>rho</span></code></pre></div>
<pre><code>##              E    V
## C 9.665421e-17 0.52</code></pre>
<p>Vに関する情報が得られたときはEに関する回帰係数が0になる→Cを推定するに当たりEに関する情報は役に立たない</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb174-1" tabindex="-1"></a><span class="co">#VがEとCと有効分離の関係にある</span></span>
<span id="cb174-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb174-2" tabindex="-1"></a><span class="fu">dsep</span>(gbn.bnlearn, <span class="st">&quot;E&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;V&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>EとVの両方を変化させた場合のCに関する分布を算出したい</p>
<p>3次元プロットは難しくエラーが発生しやすいので、二次元で観測値のポイントの大きさを変えることで表現する</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5678</span>)</span>
<span id="cb176-2"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-2" tabindex="-1"></a>cropdata3 <span class="ot">&lt;-</span> <span class="fu">cpdist</span>(gbn.bnlearn, <span class="at">nodes =</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;C&quot;</span>),</span>
<span id="cb176-3"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-3" tabindex="-1"></a>                    <span class="at">evidence =</span> <span class="cn">TRUE</span>, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb176-4"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-4" tabindex="-1"></a><span class="fu">plot</span>(cropdata3<span class="sc">$</span>V, cropdata3<span class="sc">$</span>C, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;C|V,E; E is the point size&quot;</span>)</span>
<span id="cb176-5"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-5" tabindex="-1"></a>cexlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">2.4</span>)</span>
<span id="cb176-6"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-6" tabindex="-1"></a>cexE <span class="ot">&lt;-</span> cexlim[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">diff</span>(cexlim) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(cropdata3<span class="sc">$</span>E) <span class="sc">*</span></span>
<span id="cb176-7"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-7" tabindex="-1"></a>                                          (cropdata3<span class="sc">$</span>E <span class="sc">-</span> <span class="fu">min</span>(cropdata3<span class="sc">$</span>E)))</span>
<span id="cb176-8"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-8" tabindex="-1"></a><span class="fu">points</span>(cropdata3<span class="sc">$</span>V, cropdata3<span class="sc">$</span>C, <span class="at">cex =</span> cexE<span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb176-9"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-9" tabindex="-1"></a>cqa <span class="ot">&lt;-</span> <span class="fu">quantile</span>(cropdata3<span class="sc">$</span>C, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb176-10"><a href="連続型データ事例ガウシアンベイジアンネットワーク.html#cb176-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cqa, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="離散型データ事例.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="混合事例条件付きガウシアンベイジアンネットワーク.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
